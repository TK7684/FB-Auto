============================= test session starts =============================
platform win32 -- Python 3.12.4, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\ttapk\AppData\Local\Programs\Python\Python312\python.exe
cachedir: .pytest_cache
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: C:\Users\ttapk\PycharmProjects\pythonProject\AI bot for FB page
plugins: anyio-4.12.1, langsmith-0.6.3, asyncio-1.2.0, benchmark-5.1.0, cov-4.1.0, flask-1.3.0, mock-3.14.1, profiling-1.8.1
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 15 items

tests/test_filters.py::test_filters All filter tests passed!
PASSED
tests/test_filters.py::test_user_filters All user filter tests passed!
PASSED
tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint PASSED
tests/test_health_api.py::TestHealthEndpoints::test_readiness_endpoint PASSED
tests/test_health_api.py::TestHealthEndpoints::test_liveness_endpoint PASSED
tests/test_health_api.py::TestHealthEndpoints::test_metrics_endpoint PASSED
tests/test_health_api.py::TestHealthEndpoints::test_config_endpoint PASSED
tests/test_health_api.py::TestRootEndpoint::test_root_endpoint PASSED
tests/test_webhooks.py::TestWebhookVerification::test_webhook_verification_success 2026-02-06 15:45:00 | INFO     | api.webhooks:verify_webhook:43 - Webhook verification request: mode=subscribe, token=test_token...
PASSED
tests/test_webhooks.py::TestWebhookVerification::test_webhook_verification_invalid_token 2026-02-06 15:45:00 | INFO     | api.webhooks:verify_webhook:43 - Webhook verification request: mode=subscribe, token=wrong_toke...
2026-02-06 15:45:00 | WARNING  | api.webhooks:verify_webhook:52 - Webhook verification failed
PASSED
tests/test_webhooks.py::TestWebhookVerification::test_webhook_verification_missing_params 2026-02-06 15:45:00 | INFO     | api.webhooks:verify_webhook:43 - Webhook verification request: mode=None, token=None...
2026-02-06 15:45:00 | WARNING  | api.webhooks:verify_webhook:52 - Webhook verification failed
PASSED
tests/test_webhooks.py::TestWebhookPayloads::test_webhook_message_payload 2026-02-06 15:45:00 | INFO     | api.webhooks:handle_webhook:68 - Received webhook payload with 1 entries
--- Logging error in Loguru Handler #1 ---
Record was: {'elapsed': datetime.timedelta(seconds=53, microseconds=223860), 'exception': None, 'extra': {'timestamp': '2026-02-06 15:45:00'}, 'file': (name='webhooks.py', path='C:\\Users\\ttapk\\PycharmProjects\\pythonProject\\AI bot for FB page\\api\\webhooks.py'), 'function': 'process_messaging_event', 'level': (name='INFO', no=20, icon='\u2139\ufe0f'), 'line': 136, 'message': '\U0001f4e8 Message from user123: \u0e40\u0e1b\u0e47\u0e19\u0e1d\u0e49\u0e32 \u0e43\u0e0a\u0e49\u0e15\u0e31\u0e27\u0e44\u0e2b\u0e19\u0e04\u0e30...', 'module': 'webhooks', 'name': 'api.webhooks', 'process': (id=28632, name='MainProcess'), 'thread': (id=27468, name='asyncio-portal-296d1284290'), 'time': datetime(2026, 2, 6, 15, 45, 0, 337945, tzinfo=datetime.timezone(datetime.timedelta(seconds=25200), 'SE Asia Standard Time'))}
Traceback (most recent call last):
  File "C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\site-packages\loguru\_handler.py", line 206, in emit
    self._sink.write(str_record)
  File "C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\site-packages\loguru\_simple_sinks.py", line 16, in write
    self._stream.write(message)
  File "C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f4e8' in position 76: character maps to <undefined>
--- End of logging error ---
2026-02-06 15:45:00 | ERROR    | api.webhooks:handle_incoming_message:263 - Error handling message: object MagicMock can't be used in 'await' expression
PASSED
tests/test_webhooks.py::TestWebhookPayloads::test_webhook_comment_payload 2026-02-06 15:45:00 | INFO     | api.webhooks:handle_webhook:68 - Received webhook payload with 1 entries
--- Logging error in Loguru Handler #1 ---
Record was: {'elapsed': datetime.timedelta(seconds=53, microseconds=574064), 'exception': None, 'extra': {'timestamp': '2026-02-06 15:45:00'}, 'file': (name='webhooks.py', path='C:\\Users\\ttapk\\PycharmProjects\\pythonProject\\AI bot for FB page\\api\\webhooks.py'), 'function': 'process_feed_change', 'level': (name='INFO', no=20, icon='\u2139\ufe0f'), 'line': 174, 'message': '\U0001f4ac Comment comment123 on post post123 from : \u0e2a\u0e34\u0e27\u0e40\u0e22\u0e2d\u0e30\u0e04\u0e48\u0e30 \u0e41\u0e19\u0e30\u0e19\u0e33\u0e15\u0e31\u0e27\u0e44\u0e2b\u0e19\u0e14\u0e35...', 'module': 'webhooks', 'name': 'api.webhooks', 'process': (id=28632, name='MainProcess'), 'thread': (id=31588, name='asyncio-portal-296d12869c0'), 'time': datetime(2026, 2, 6, 15, 45, 0, 688149, tzinfo=datetime.timezone(datetime.timedelta(seconds=25200), 'SE Asia Standard Time'))}
Traceback (most recent call last):
  File "C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\site-packages\loguru\_handler.py", line 206, in emit
    self._sink.write(str_record)
  File "C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\site-packages\loguru\_simple_sinks.py", line 16, in write
    self._stream.write(message)
  File "C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f4ac' in position 72: character maps to <undefined>
--- End of logging error ---
2026-02-06 15:45:00 | ERROR    | api.webhooks:handle_comment:349 - Error handling comment: object MagicMock can't be used in 'await' expression
PASSED
tests/test_webhooks.py::TestWebhookPayloads::test_webhook_empty_entry 2026-02-06 15:45:00 | INFO     | api.webhooks:handle_webhook:68 - Received webhook payload with 0 entries
PASSED
tests/test_webhooks.py::TestWebhookPayloads::test_webhook_malformed_payload 2026-02-06 15:45:00 | INFO     | api.webhooks:handle_webhook:68 - Received webhook payload with 0 entries
PASSED

============================== warnings summary ===============================
tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint
  C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\site-packages\pytz\tzinfo.py:27: DeprecationWarning: datetime.datetime.utcfromtimestamp() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.fromtimestamp(timestamp, datetime.UTC).
    _epoch = datetime.utcfromtimestamp(0)

tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint
  C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\site-packages\dateutil\tz\tz.py:37: DeprecationWarning: datetime.datetime.utcfromtimestamp() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.fromtimestamp(timestamp, datetime.UTC).
    EPOCH = datetime.datetime.utcfromtimestamp(0)

tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint
  C:\Users\ttapk\PycharmProjects\pythonProject\AI bot for FB page\services\gemini_service.py:8: FutureWarning: 
  
  All support for the `google.generativeai` package has ended. It will no longer be receiving 
  updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
  See README for more details:
  
  https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md
  
    import google.generativeai as genai

tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint
  C:\Users\ttapk\PycharmProjects\pythonProject\AI bot for FB page\main.py:178: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("startup")

tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint
tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint
  C:\Users\ttapk\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\applications.py:4579: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    return self.router.on_event(event_type)

tests/test_health_api.py::TestHealthEndpoints::test_health_endpoint
  C:\Users\ttapk\PycharmProjects\pythonProject\AI bot for FB page\main.py:190: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("shutdown")

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 15 passed, 7 warnings in 55.31s =======================
